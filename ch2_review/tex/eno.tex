\section{Energy-Neutral Computing} \label{sec:en}

Energy-neutral (EN) computing aims to operate sensor nodes with at least a certain performance level over a period of time. Energy-neutrality can be described as the following equation:

\begin{equation} \label{eq:energyneutral}
    E_{min} \leq E_{t_0} + \int_{t_0}^{t_0+\Delta t} [P_h(t) - P_c(t)] dt \leq E_{max}
\end{equation} 

where $P_h(t)$ and $P_c(t)$ are the harvested and consumed power at time $t$, $t_0$ is the time when EN computing is meant to start, $\Delta t$ is the length of period during which EN conditions are achieved, $E_{t_0}$ is the initial available energy in energy storage at time $t_0$, $E_{min}$ is the minimum amount of stored energy below which the system cannot sustain (typically due to insufficient supply voltage), and $E_{max}$ is the maximum capacity of energy storage beyond which the harvested energy is wasted. $P_c(t)$ includes the power consumption of the whole system, such as the MCU, peripherals, power conversion circuit, and the power leakage of energy storage. $P_h(t)$ is the harvested power after conversion. 

EN devices are typically powered by solar cells~\cite{escolar2014energy}, and $\Delta t$ is typically 24 hours or one year to suit the period of the solar energy source. In order to achieve energy neutrality over such a long term, sufficient amount of energy storage, typically in the form of rechargeable batteries, is required to smooth out the large temporal variations of harvested power. The capacity of the energy storage is determined by how long the system tries to maintain a stable performance as larger energy storage tolerates more energy differences. In general, the length of $\Delta t$ and the difference between $P_h$ and $P_c$ determine how much storage is required, and on the other hand, the capacity of energy storage limits how long $\Delta t$ can be.

In order to ensure that the system works uninterruptedly by managing the stored energy (the middle term in Equation~\ref{eq:energyneutral}) between $E_{min}$ and $E_{max}$, EN computing dynamically adapts system performance and power consumption over the period $\Delta t$. Typical adapting techniques include adjusting workload duty cycles and participation in network activity~\cite{merrett2017energy}.

% In the following part of this section, most of the mentioned power management methods are based on solar energy harvesting.

Kansal \textit{et al.}~\cite{kansal2007power} illustrate a preliminary power management algorithm by which the incoming energy is estimated by an Exponentially Weighted Moving Average (EWMA) of the past recorded slots of harvested energy, and the system tries to exploit the harvested energy by scaling its duty cycles. Vigorito \textit{et al.}~\cite{vigorito2007adaptive} introduce a Linear-Quadratic Tracking (LQT) approach to scale duty cycles based on the current battery level, and as evaluated in its datasets, mean duty cycle is improved by 6-32\% and duty-cycle variation is reduced by 6-69\% compared to~\cite{kansal2007power}, which means the system works with a more a stable performance. In~\cite{le2012power}, a Proportional-Integral-Derivative (PID) controller is used for monitoring and stabilizing the voltage of a supercapacitor-based energy storage, and hence, the storage level of this system. While these approaches achieve satisfactory energy neutrality for the magnitude of hours, they all show a latency when responding to the harvested power, and high variance of duty cycles when adapting to a new power trace. Additionally, approaches in~\cite{vigorito2007adaptive} and~\cite{kansal2007power} rely on an accurate estimating algorithm to detect the remaining battery energy, which is vulnerable to deployed time and temperature. 

In~\cite{piorno2009prediction}, a prediction algorithm for solar energy named Weather-Conditioned Moving Average (WCMA) is presented, in which both the current and the past weather data are taken into account to achieve higher accuracy than EWMA methods. It is reported by the authors that the average prediction error is improved from 28.6\% in EWMA to 9.8\% in WCMA over a test duration of 45 days, but it is unclear in the article that how to harness this prediction to improve the system performance. Similarly, weather forecast is adopted in~\cite{sharma2010cloudy}, by which the authors build a model to approximate the available solar and wind energy. Although these two methods based on weather data provide high prediction accuracy, the network overheads for receiving these data are not presented, and how to fully utilise this daily prediction is still a problem.

Different from the aforementioned daily EN operations, a long-term annual power management based on duty-cycling is presented in~\cite{buchli2014dynamic} to achieve annual energy neutrality. The authors use an adjustment factor, which is dynamically calculated from the historical windows, to modify the design-time energy prediction model to a more realistic model, and determine its performance level accordingly. However, this algorithm is only tested in simulation instead of practical experiments. Moreover, for such a long-term EN operation, a large battery is required, but the battery deterioration is ignored in their analysis.

In~\cite{caruso2018dynamic}, a task scheduling algorithm for optimising the performance of an energy harvesting system (typically based on PV harvesters) is exhibited. Given a predicted power trace, storage bounds, energy consumption of tasks and quality of tasks, the proposed scheduling algorithm is proved to be able to find the optimal scheduling in a pseudo-polynomial time which leads to the maximum sensing quality. While this algorithm provides an ideal solution for power management, it requires that the energy source should be predictable with high accuracy, and the energy cost and quality of each task should be defined at design time. The first requirement almost constrains this algorithm within the cooperation of solar energy. The second requirement is hard to achieve since a) in practice the energy consumption of tasks may change due to temperature and dynamic data amount~\cite{walker2016thermally} and b) the energy cost of a system includes many elements other than the energy consumption of computing tasks.

EN computing efficiently utilises energy and maintains system performance, ensure reliability and periodic task execution despite variable harvesting power input. However, in almost all energy neutral approaches reviewed above, a large energy storage, i.e. a rechargeable battery, is in need in order to buffer temporal energy variations. The usage of batteries poses sustainability challenges due to the limited lifetime and pollution issues. Recent research develops intermittent computing and power-neutral computing, which minimise the need for energy storage. The next two sections (Section \ref{sec:ips} and Section \ref{Section:PN}) review the methodologies of these two research topics. 